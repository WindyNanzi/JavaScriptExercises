<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>shink-and-grow</title>
  <link rel="stylesheet" href="./shrink-and-grow.css">
</head>
<body>
  <h2>flex-grow</h2>
  <section class="grow">
    <div class="example grow-default">
      <div>
        <div class="box-info">
          <p>flex-basis: 50px</p>
          <p>flex-grow: 1</p>
          <details>
            <p>当前宽度:100px</p>
          </details>
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basis:100px</p>
          <p>flex-grow:3</p>
          <details>
            <p>当前宽度: 250px</p>
          </details>
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basis:150px</p>
          <p>flex-grow:2</p>
          <details>
            <p>当前宽度: 250px</p>
          </details>
        </div>
      </div>
    </div>
    <details>
      <summary>计算方法</summary>
      <pre>
        容器宽度：600px
        总伸缩系数：1 + 3 + 2 = 6
        空闲宽度：600 - (50 + 100 + 150) =  300
        项目1的flex宽度： 50 + 300 * 1/6 = 100px 
        项目2的flex宽度： 100 + 300 * 3/6 = 250px 
        项目3的flex宽度： 150 + 300 * 2/6 = 250px 
      </pre>
    </details>
    <h3>padding</h3>
    <div class="example grow-padding">
      <div>
        <div class="box-info">
          <p>flex-basis:50px</p>
          <p>flex-grow:1</p>
          <p>padding:0 25px</p>
          <details>
            <p>当前宽度:125px</p>
          </details>
          
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basis:100px</p>
          <p>flex-grow:3</p>
          <p>padding:0 25px</p>
          <details>
            <p>当前宽度:225px</p>
          </details>
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basis:150px</p>
          <p>flex-grow:2</p>
          <p>padding:0 25px</p>
          <details>
            <p>当前宽度:250px</p>
          </details>
        </div>
      </div>
    </div>
  </section>
  <h2>flex-shrink:</h2>
  <section class="shrink">
    <h3>test:</h3>
    <pre>
      容器宽度：600px
      flex-shrink：1 , 3 , 2 
      flex-basis: 600px, 600px, 600px
      求各个容器的宽度
    </pre>
    <details>
      <div class="example shrink-test">
        <div>
          <div class="box-info">
            <p>flex-basis:600px</p>
            <p>flex-shrink:1</p>
            <details>
              <p>当前宽度:400px</p>
            </details>
          </div>
        </div>
        <div>
          <div class="box-info">
            <p>flex-basis:600px</p>
            <p>flex-shrink:3</p>
            <details>
              <p>当前宽度: 0</p>
            </details>
          </div>
        </div>
        <div>
          <div class="box-info">
            <p>flex-basis:600px</p>
            <p>flex-shrink:2</p>
            <details>
              <p>当前宽度:200px</p>
            </details>
          </div>
        </div>
      </div>
    </details>
    <details>
      <summary>计算过程</summary>
      <pre>
        容器宽度：600px
        溢出宽度：600*3 - 600 =  1200
        项目1的flex宽度： 600 - 1200 * 1/6 = 400px 
        项目2的flex宽度： 600 - 1200 * 3/6 = 0px 
        项目3的flex宽度： 600 - 1200 * 2/6 = 200px 
      </pre>
    </details>
    <h3>defalut:</h3>
    <div class="example shrink-default">
      <div>
        <div class="box-info">
          <p>flex-basis: 200px</p>
          <p>flex-shrink: 1</p>
          <details>
            <p>当前宽度: 150px</p>
          </details>
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basis: 600px</p>
          <p>flex-shrink: 3</p>
          <details>
            <p>当前宽度: 150px</p>
          </details>
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basis: 400px</p>
          <p>flex-shrink: 1</p>
          <details>
            <p>当前宽度: 300px</p>
          </details>
        </div>
      </div>
    </div>
    <h3>padding:</h3>
    <p>flex-basic: 150px; padding:0 75px;</p>
    <pre>
      shrink总系数：1+3+2 = 6
      项目总宽度：(150 + 75*2) * 3 = 900px
      超出宽度：900 - 600 = 300px
      项目1宽度： (75*2) + $((150 - (1/6) * 300)) = 250px
      项目2宽度： (75*2) + $((150 - (3/6) * 300)) = 150px
      项目3宽度： (75*2) + $((150 - (2/6) * 300)) = 200px
    </pre>
    <div class="example shrink-padding">
      <div>
        <div class="box-info">
          <p>flex-basic: 100px</p>
          <p>flex-shrink: 1</p>
          <p>padding: 50px</p>
          <p>当前宽度: 175px</p>
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basic: 700px</p>
          <p>flex-shrink: 5</p>
          <p>padding: 50px</p>
          <p>当前宽度: 100px</p>
        </div>
      </div>
      <div>
        <div class="box-info">
          <p>flex-basic: 300px</p>
          <p>flex-shrink: 1</p>
          <p>padding: 50px</p>
          <p>当前宽度: 325px</p>
        </div>
      </div>
    </div>
    <h3>margin: 同padding, 但着色由盒子宽度+padding宽度决定，所以着色不一致</h3>
    <div class="example shrink-margin">
      <div></div>
      <div></div>
      <div></div>
    </div>
    <h3>margin+padding: 计算原理与上面一致。</h3>
    <pre>
      shrink总系数：1+3+2 = 6
      项目总宽度：(200 + 25*2 + 25*2) * 3 = 900px
      超出宽度：900 - 600 = 300px
      项目1宽度： (25*4) + $((200 - (1/6) * 300)) = 250px
      项目2宽度： (25*4) + $((200 - (3/6) * 300)) = 150px
      项目3宽度： (25*4) + $((200 - (2/6) * 300)) = 200px
    </pre>
    <h3>
      <p>存在flex-shink元素宽度计算公式：</p>
      <p>盒子的flex-box宽度 = padding + border + margin + (盒子预设定宽度 - (盒子的flex-shrink / 盒子所在容器的总flex-shrink)*(盒子原来的总宽度 - 容器盒子宽度))</p>
    </h3>
    <div class="example shrink-padding-margin">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </section>

  <h2>总结计算公式:</h2>
  <p>令 Wf 为 项目经过flex伸缩变化后的宽度 </p>
  <p>令 Wc 为 容器的宽度</p>
  <p>令 Wr 为 项目的真实宽度</p>
  <p>令 Wi 为 项目的盒子宽度(margin + border + padding + Wr)</p>
  <p>令 Wic 为所有项目加起来的盒子宽度总和</p>
  <p>令 Fi 为项目的伸缩系数</p>
  <p>令 Fic 为所有项目的伸缩系数和</p>
  <p>令 有函数 <code> $ </code>接收一个number, 如果number < 0 ,则返回 0，否则， 返回 number</p>
  <p> <b>在grow下：</b> </p>
  <p><b> Wf = Wi + $(Wc - Wic)*(Fi / Fic) </b></p>
  <p> <b>在shrink下：</b> </p>
  <p><b> Wf = (Wi - Wr) + $(Wr - $(Wic - Wc)*(Fi / Fic)) </b></p>
  <p> 注意 shrink 下公式不可以 变成 Wf = $(Wi - $(Wic - Wc)*(Fi / Fic)), 因为padding 与 margin 的宽度恒定不变</p>

  <h3>shrink 的 特殊情况... </h3>
  <p>日常开发中不经常将一个元素的宽度设置为0</p>
  <section class="segment shrink">
    <p>给其一个min-width:150px</p>
    <div class="example shrink-special">
      <div>
        <p>shrink: 1</p>
        <p>width: 600 - 250 = 350px</p>
      </div>
      <div>
        <p>shrink: 3</p>
        <p>min-width: 150px</p>
      </div>
      <div>
        <p>shrink: 2</p>
        <p>width: 600 - 500 = 100px</p>
      </div>
    </div>
    <p><b>稍加计算可以推测出 250px = ((600*2 + 150) - 600) * 1/3; </b></p>
    <p><b>可得出结论：在min-width生效时，min-width项目的伸缩系数不再进入计算公式，或者那时候的项目伸缩系数为0，同理grow下的max-width也应遵循这个定理</b></p>
  </section>
  <h3>参考： https://drafts.csswg.org/css-flexbox-1/#abspos-items</h3>
</body>
</html>